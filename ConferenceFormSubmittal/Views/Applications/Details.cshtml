@model ConferenceFormSubmittal.Models.Application
@using ConferenceFormSubmittal.Utilities;

@{
    ViewBag.Title = "Details";
}

<!--HEADING-->
<div class="row pt-3">
    <div class="col-12">
        <div class="card card-header bg-NCDSB-Grey">
            <h3 class="text-center font-weight-bold">Application Details</h3>

        </div>
    </div>
</div>

<div class="row mt-3">
    <div class="col-12">
        <div class="card card-body bg-NCDSB-Grey">
            <div class="row">
                <div class="col-5">

                    @Html.LabelFor(model => model.ConferenceID, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                    @Html.DisplayFor(model => model.Conference.Name)

                    @Html.LabelFor(model => model.Conference.StartDate, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                    @Html.DisplayFor(model => model.Conference.StartDate)

                    @Html.LabelFor(model => model.Conference.EndDate, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                    @Html.DisplayFor(model => model.Conference.EndDate)

                </div>

                <div class="col-5">

                    @Html.LabelFor(model => model.Conference.Location, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                    @Html.DisplayFor(model => model.Conference.Location)

                    @Html.LabelFor(model => model.Conference.RegistrationCost, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                    @Html.DisplayFor(model => model.Conference.RegistrationCost)

                </div>

                <div class="col-2">

                    <a href='@Url.Action("Delete", "Applications", new { id = Model.ID })' class="btn btn-danger btn-block">
                        <i class="fa fa-flag fa-2x"></i>
                        Flag
                    </a>
 

                </div>
            </div>
           
        </div>
    </div> <!--col-->
</div>

<div class="row">

    <div class="col-12">

        <div class="row">
            <div class="col-12">
                <div class="card card-body bg-NCDSB-Grey mt-3">
                    <div class="row">
                        <div class="col-4">
                            @Html.LabelFor(model => model.DateSubmitted, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.DateSubmitted)

                            @Html.LabelFor(model => model.AttendStartDate, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.AttendStartDate)

                            @Html.LabelFor(model => model.AttendEndDate, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.AttendEndDate)

                            @Html.LabelFor(model => model.DepartureDate, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.DepartureDate)

                            @Html.LabelFor(model => model.ReturnDate, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.ReturnDate)
                        </div>
                        <div class="col-4">
                            @Html.LabelFor(model => model.Rationale, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.Rationale)

                            @Html.LabelFor(model => model.PaymentType.Description, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.PaymentType.Description)

                            @Html.LabelFor(model => model.BudgetCode, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.BudgetCode)

                            @Html.LabelFor(model => model.ReplStaffReq, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Helper.YesNoFromBool(Model.ReplStaffReq)
                        </div>
                        <div class="col-4">
                            @Html.LabelFor(model => model.Status, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.Raw(Helper.StatusIcon(Model.Status.Description)) @Html.DisplayFor(model => model.Status.Description)

                            @Html.LabelFor(model => model.Feedback, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                            @Html.DisplayFor(model => model.Feedback)
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card card-body bg-NCDSB-Grey mt-3">
                    <div class="col-12">
                        <h5>Expenses</h5>

                        <table class="table">
                            <thead>
                                <tr>
                                    <th>
                                        @Html.LabelFor(model => model.Expenses.SingleOrDefault().ExpenseTypeID, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                    <th>
                                        @Html.LabelFor(model => model.Expenses.SingleOrDefault().EstimatedCost, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                    <th>
                                        @Html.LabelFor(model => model.Expenses.SingleOrDefault().ActualCost, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                    <th>
                                        @Html.LabelFor(model => model.Expenses.SingleOrDefault().Rationale, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Expenses)
                            {
                                var estimatedCost = item.EstimatedCost?.ToString("C");

                                if (String.IsNullOrEmpty(estimatedCost))
                                {
                                    estimatedCost = "N/A";
                                }

                                var actualCost = item.ActualCost?.ToString("C");

                                if (String.IsNullOrEmpty(actualCost))
                                {
                                    actualCost = "TBD";
                                }
                                <tr>
                                    <td>@item.ExpenseType.Description</td>
                                    <td>@estimatedCost</td>
                                    <td>
                                        @actualCost
                                    </td>
                                    <td>@item.Rationale</td>
                                </tr>
                        }
                            </tbody>
                        </table>


                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card card-body bg-NCDSB-Grey mt-3">
                    <div class="col-12">
                        <h5>Mileage</h5>

                        <table class="table">
                            <thead>
                                <tr>
                                    <th>
                                        @Html.LabelFor(model => model.Mileages.SingleOrDefault().TravelDate, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                    <th>
                                        @Html.LabelFor(model => model.Mileages.SingleOrDefault().StartAddress, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                    <th>
                                        @Html.LabelFor(model => model.Mileages.SingleOrDefault().EndAddress, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                    <th>
                                        @Html.LabelFor(model => model.Mileages.SingleOrDefault().Kilometres, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                    <th>
                                        @Html.LabelFor(model => model.Mileages.SingleOrDefault().Status, htmlAttributes: new { @class = "control-label d-block font-weight-bold" })
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.Mileages)
                                {
                                <tr>
                                    <td>
                                        @item.TravelDate.ToShortDateString()
                                    </td>
                                    <td>
                                        @item.StartAddress
                                    </td>
                                    <td>
                                        @item.EndAddress
                                    </td>
                                    <td>
                                        @item.Kilometres km
                                    </td>
                                    <td>
                                        @Html.Raw(Helper.StatusIcon(item.Status.Description))
                                        @item.Status.Description
                                    </td>
                                </tr>
                                }
                            </tbody>
                        </table>


                    </div>
                </div>
            </div>
        </div>
    </div> <!--col-->
</div>